{"title":"Vue构建出来的版本","description":"vue通过rollup构建工具构建出来的版本有哪些，都有什么差别","keywords":"vue","labels":["vue源码，构建，esmodule版，commonjs版，全版本，运行时，runtime，compiler，编译器版本"],"date":"2021-08-12","path":"2021/08/vue-built-version.md","slug":"2021_08_vue-built-version","html":"<p><div style=\"text-align: center;\"><img align=\"center\" style=\"width: -webkit-fill-available;margin-bottom: 20px;border-radius: 8px;background: #f8fdf3;\" data-zoomable src=\"https://i.loli.net/2021/08/12/gPNOFU8ycMaV9Jh.png\" alt=\"图 2\" ></div>  </p>\n<h3 id=\"vue构建版本\">Vue构建版本</h3>\n<p>vue构建的版本好多，可以从上图看到。从源码的构建上了解vue构建的版本。</p>\n<p>从<code>/scripts/config.js</code>中看到，<code>builds</code>常量定义了各个构建版本的配置。比如：</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-string\">&#x27;web-runtime-cjs-dev&#x27;</span>: {\n  entry: <span class=\"hljs-built_in\">resolve</span>(<span class=\"hljs-string\">&#x27;web/entry-runtime.js&#x27;</span>),\n  des<span class=\"hljs-variable\">t:</span> <span class=\"hljs-built_in\">resolve</span>(<span class=\"hljs-string\">&#x27;dist/vue.runtime.common.dev.js&#x27;</span>),\n  forma<span class=\"hljs-variable\">t:</span> <span class=\"hljs-string\">&#x27;cjs&#x27;</span>,\n  <span class=\"hljs-keyword\">en</span><span class=\"hljs-variable\">v:</span> <span class=\"hljs-string\">&#x27;development&#x27;</span>,\n  banner\n},\n</code></pre>\n<p>表示要构建出cjs格式的vue源码。而<code>web-runtime</code>也表示了只构建出runtime版本的vue源码。<code>-dev</code>则表示不会进行代码压缩，构建出来的版本属于开发版本。</p>\n<p>除了上面列举的第一个外，还有：</p>\n<ul>\n<li><code>web-runtime-cjs-prod</code>。 构建【web平台、commonjs、runtime、生产版】源码；对应输出的文件为：<code>dist/vue.runtime.common.prod.js</code>。</li>\n<li><code>web-full-cjs-dev</code>。 构建【web平台、commonjs、runtime、compiler、开发版】源码；对应输出的文件为：<code>dist/vue.common.dev.js</code>。</li>\n<li><code>web-full-cjs-prod</code>。 构建【web平台、commonjs、runtime、compiler、生产版】源码；对应输出的文件为：<code>dist/vue.common.prod.js</code>。</li>\n<li><code>web-runtime-esm</code>。 构建【web平台、esmodule、runtime】源码；对应输出的文件为：<code>dist/vue.esm.js</code>。</li>\n<li><code>web-full-esm</code>。 构建【web平台、esmodule、runtime、compiler】源码；对应输出的文件为：<code>dist/vue.esm.js</code>。</li>\n<li><code>web-full-esm-browser-dev</code>。 构建【web平台、esmodule、runtime、compiler、浏览器直接引入、开发版】源码；对应输出的文件为：<code>dist/vue.esm.browser.js</code>。</li>\n<li><code>web-full-esm-browser-prod</code>。 构建【web平台、esmodule、runtime、compiler、浏览器直接引入、生产版】源码；对应输出的文件为：<code>dist/vue.esm.browser.min.js</code>。</li>\n<li><code>web-runtime-dev</code>。 构建【web平台、runtime、umd、开发版】源码；对应输出的文件为：<code>dist/vue.runtime.js</code>。</li>\n<li><code>web-runtime-prod</code>。 构建【web平台、runtime、umd、生产版】源码；对应输出的文件为：<code>dist/vue.runtime.min.js</code>。</li>\n<li><code>web-full-dev</code>。 构建【web平台、runtime、umd、compiler、开发版】源码；对应输出的文件为：<code>dist/vue.js</code>。</li>\n<li><code>web-full-prod</code>。 构建【web平台、runtime、umd、compiler、生产版】源码；对应输出的文件为：<code>dist/vue.min.js</code>。</li>\n<li><code>web-compiler</code>。 构建【web平台、commonjs、compiler】源码；对应输出的文件为：<code>packages/vue-template-compiler/build.js</code>。</li>\n<li><code>web-compiler-browser</code>。 构建【web平台、commonjs、compiler】源码；对应输出的文件为：<code>packages/vue-template-compiler/browser.js</code>。</li>\n<li><code>web-server-renderer-dev</code>。 构建【服务端、commonjs、开发版】源码；对应输出的文件为：<code>packages/vue-server-renderer/build.dev.js</code>。</li>\n<li><code>web-server-renderer-prod</code>。 构建【服务端、commonjs、生产版】源码；对应输出的文件为：<code>packages/vue-server-renderer/build.prod.js</code>。</li>\n<li><code>web-server-renderer-basic</code>。 构建【服务端、umd、basic版】源码；对应输出的文件为：<code>packages/vue-server-renderer/basic.js</code>。</li>\n<li><code>web-server-renderer-webpack-server-plugin</code>。 构建【服务端、commonjs、服务端插件版】源码；对应输出的文件为：<code>packages/vue-server-renderer/server-plugin.js</code>。</li>\n<li><code>web-server-renderer-webpack-client-plugin</code>。 构建【服务端、commonjs、客户端插件版】源码；对应输出的文件为：<code>packages/vue-server-renderer/client-plugin.js</code>。</li>\n</ul>\n<h2 id=\"版本区别\">版本区别</h2>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>UMD</th>\n<th>CommonJS</th>\n<th>ES Module</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><strong>全版本</strong></td>\n<td>vue.js</td>\n<td>vue.common.js</td>\n<td>vue.esm.js</td>\n</tr>\n<tr>\n<td><strong>只包含运行时</strong></td>\n<td>vue.runtime.js</td>\n<td>vue.runtime.common.js</td>\n<td>vue.runtime.esm.js</td>\n</tr>\n<tr>\n<td><strong>全版本（生产版）</strong></td>\n<td>vue.min.js</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><strong>只包含运行时（生产版）</strong></td>\n<td>vue.runtime.min.js</td>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<ul>\n<li><p><strong>Full</strong>: 包含了编译器和运行时。</p>\n</li>\n<li><p><strong>Compiler</strong>: 编译版本。可以把template字符串代码编译为javascript render函数。</p>\n</li>\n<li><p><strong>Runtime</strong>: 用来创建 Vue 实例、渲染并处理虚拟 DOM 等的代码。基本上就是除去编译器的其它一切。</p>\n</li>\n<li><p><strong><a target='_blank'  href=\"https://github.com/umdjs/umd\">UMD</a></strong>: UMD 版本可以通过 <script> 标签直接用在浏览器中。</p>\n</li>\n<li><p><strong><a target='_blank'  href=\"http://wiki.commonjs.org/wiki/Modules/1.1\">CommonJS</a></strong>: CommonJS 版本用来配合老的打包工具比如 Browserify 或 webpack 1。这些打包工具的默认文件 (pkg.main) 是只包含运行时的 CommonJS 版本 (vue.runtime.common.js)。</p>\n</li>\n<li><p><strong><a target='_blank'  href=\"http://exploringjs.com/es6/ch_modules.html\">ES Module</a></strong>: ES module版本提供给现代的打包工具，比如webpack2、rollup。为这些打包工具提供的默认文件 (pkg.module) 是只有运行时的 ES Module 构建 (vue.runtime.esm.js)</p>\n</li>\n</ul>\n<p>一般也是要用运行时的版本，运行时版本只占用全版本提及的30%。我们在使用webpack的vue-loader工具最后到网页的呈现时，用的就是运行时的版本，<code>*.vue</code> 文件内部的模板会在构建时预编译成 JavaScript render函数。</p>\n"}