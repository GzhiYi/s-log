<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=1280" name=viewport> <meta content=#333333 name=theme-color> <meta content=Mrn4dXO3Z_939geeswIgr2wIpspT6n7X5cX1Tjp69Ko name=google-site-verification> <base href=/ > <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest crossorigin=use-credentials> <link href=favicon.png rel=icon type=image/png> <link href=atom-one-light.min.css rel=stylesheet> <link href=client/client-8a023c34.css rel=stylesheet><link href=client/[slug]-669d1caa.css rel=stylesheet> <title>记一次Maximum call stack size exceeded error-GzhiYi's blog</title><meta content="vue开发项目中出现Maximum call stack size exceeded error错误，仔细看了错误信息，查找了一些资料都没有解决。" name=description data-svelte=svelte-2vncnt><meta content=Maximu-call-stack-size-exceeded-error，vue，prettier，cicd，local，production name=keywords data-svelte=svelte-2vncnt> <link href=/client/client.1097f7bb.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/client-8a023c34.css rel=preload as=style><link href=/client/[slug].71aad685.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/config.026ad977.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/inject_styles.5607aec6.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/[slug]-669d1caa.css rel=preload as=style></head> <body> <div id=sapper> <nav class=svelte-1dbd5up><ul class=svelte-1dbd5up> <li class=svelte-1dbd5up><a href=blog aria-current=page class=svelte-1dbd5up rel=prefetch>blog</a></ul></nav> <main class=svelte-1ca6gui> <div class="svelte-1h4sz93 base"><div class="svelte-1h4sz93 title">记一次Maximum call stack size exceeded error</div> <span class="svelte-1h4sz93 author">GzhiYi · 2021-07-31</span> <div class=label>vue</div></div> <div class="svelte-1h4sz93 content"><p>一次在ci打包编译vue项目，上线到测试环境后出现了Maximum call stack size exceeded error错误。</p> <p>这个错误意思是堆栈溢出。本地环境无任何这样的问题，但经过ci跑完之后就出现这个问题。 错误提示指向了打包后的js文件，由于代码压缩uglifyjs，所以直接是看不到错误根源的。在搜索了相关的资料后，有提到是vue单页面组件中存在重复定义的变量。但我有引用lint工具，如果出现这样但情况git提交是无法顺利进行的。</p> <h2 id=切换部署代码>切换部署代码</h2> <p>把部署到测试环境的代码回退到上一个tag，意在排除是代码的问题。结果回退到上一个tag后，经过ci部署，线上仍旧出现这个情况。</p> <p>经过一步步推测，觉得就是在打包编译的过程中出现了问题。</p> <h2 id=问题原因>问题原因</h2> <p>在ci到log日志中，发现代码在build的过程中，prettier出现了不少的错误。所以根源就在于本地和docker镜像中的项目build所需要的某个package出现异常。 而异常就应该出现在prettier上。</p> <h2 id=问题处理>问题处理</h2> <p>要是出自某个package上，只能是package的版本不一致导致的。在package.json中，看到版本：</p> <pre><code class=language-json><span class=hljs-string>"prettier"</span>: <span class=hljs-string>"^2.0.2"</span>
</code></pre> <p>这个版本符号"^"是插入符号，这会安装当前的主要版本，例如上面的版本的话，会更新到2.x.x最新的版本。这就会可能引起版本的不一致。</p> <p>把这个符号移除掉，固定版本号之后，ci也不会出现问题，上线就恢复正常了。</p> <h2 id=packagejson版本总结>package.json版本总结</h2> <p>package.json中的版本号有3个位。例如：<code>1.12.2</code></p> <p>从左到右，第一个数字为主版本号（marjor version），第二个数字为次版本号（minor version），第三个数字为补丁版本号（patch version）。</p> <p><code>~</code>: 更新中间数字的最新版本。如<code>~1.3.1</code>会更新1.3.x最新版本。 <code>^</code>: 更新第一个数字但最新版本。如<code>^1.3.1</code>会更新1.x.x最新版本。</p> </div> <div class="svelte-1h4sz93 contact"><div>如果你对这页内容有疑问，欢迎联系我！</div> <a href="mailto:zhiyi.gong@outlook.com?subject=【重要】记一次Maximum call stack size exceeded error&body=gzhiyi.top/blog/2021_07_Maximum-call-stack-size-exceeded-error" target=_blank>邮箱 </a> <br> <a href=https://github.com/gzhiyi target=_blank>github </a> </div> </main></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,{post:{title:"记一次Maximum call stack size exceeded error",description:"vue开发项目中出现Maximum call stack size exceeded error错误，仔细看了错误信息，查找了一些资料都没有解决。",keywords:"Maximu-call-stack-size-exceeded-error，vue，prettier，cicd，local，production",labels:["vue"],date:"2021-07-31",path:"2021\u002F07\u002FMaximum-call-stack-size-exceeded-error.md",slug:"2021_07_Maximum-call-stack-size-exceeded-error",html:"\u003Cp\u003E一次在ci打包编译vue项目，上线到测试环境后出现了Maximum call stack size exceeded error错误。\u003C\u002Fp\u003E\n\u003Cp\u003E这个错误意思是堆栈溢出。本地环境无任何这样的问题，但经过ci跑完之后就出现这个问题。\n错误提示指向了打包后的js文件，由于代码压缩uglifyjs，所以直接是看不到错误根源的。在搜索了相关的资料后，有提到是vue单页面组件中存在重复定义的变量。但我有引用lint工具，如果出现这样但情况git提交是无法顺利进行的。\u003C\u002Fp\u003E\n\u003Ch2 id=\"切换部署代码\"\u003E切换部署代码\u003C\u002Fh2\u003E\n\u003Cp\u003E把部署到测试环境的代码回退到上一个tag，意在排除是代码的问题。结果回退到上一个tag后，经过ci部署，线上仍旧出现这个情况。\u003C\u002Fp\u003E\n\u003Cp\u003E经过一步步推测，觉得就是在打包编译的过程中出现了问题。\u003C\u002Fp\u003E\n\u003Ch2 id=\"问题原因\"\u003E问题原因\u003C\u002Fh2\u003E\n\u003Cp\u003E在ci到log日志中，发现代码在build的过程中，prettier出现了不少的错误。所以根源就在于本地和docker镜像中的项目build所需要的某个package出现异常。\n而异常就应该出现在prettier上。\u003C\u002Fp\u003E\n\u003Ch2 id=\"问题处理\"\u003E问题处理\u003C\u002Fh2\u003E\n\u003Cp\u003E要是出自某个package上，只能是package的版本不一致导致的。在package.json中，看到版本：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-json\"\u003E\u003Cspan class=\"hljs-string\"\u003E&quot;prettier&quot;\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-string\"\u003E&quot;^2.0.2&quot;\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E这个版本符号&quot;^&quot;是插入符号，这会安装当前的主要版本，例如上面的版本的话，会更新到2.x.x最新的版本。这就会可能引起版本的不一致。\u003C\u002Fp\u003E\n\u003Cp\u003E把这个符号移除掉，固定版本号之后，ci也不会出现问题，上线就恢复正常了。\u003C\u002Fp\u003E\n\u003Ch2 id=\"packagejson版本总结\"\u003Epackage.json版本总结\u003C\u002Fh2\u003E\n\u003Cp\u003Epackage.json中的版本号有3个位。例如：\u003Ccode\u003E1.12.2\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E从左到右，第一个数字为主版本号（marjor version），第二个数字为次版本号（minor version），第三个数字为补丁版本号（patch version）。\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ccode\u003E~\u003C\u002Fcode\u003E: 更新中间数字的最新版本。如\u003Ccode\u003E~1.3.1\u003C\u002Fcode\u003E会更新1.3.x最新版本。\n\u003Ccode\u003E^\u003C\u002Fcode\u003E: 更新第一个数字但最新版本。如\u003Ccode\u003E^1.3.1\u003C\u002Fcode\u003E会更新1.x.x最新版本。\u003C\u002Fp\u003E\n"}}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.1097f7bb.js"}catch(e){main="/client/legacy/client.acb7f38a.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@2.0.4.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-170295070-1"></script> <script> window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-170295070-1'); </script> 